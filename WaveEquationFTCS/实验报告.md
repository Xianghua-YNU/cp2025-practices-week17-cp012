# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [段林焱] **学号：** [20231050098] **完成日期：** [2025/6/18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
for j in range(1, N_t - 1):
    u[1:-1, j + 1] = c * (u[2:, j] + u[:-2, j]) + 2 * (1 - c) * u[1:-1, j] - u[1:-1, j - 1]
    u[0, j + 1] = 0  # 边界条件 u(0, t) = 0
    u[-1, j + 1] = 0  # 边界条件 u(L, t) = 0
```
此代码段通过前一时间步和当前时间步的位移值计算下一时间步的位移，并确保边界条件得到满足。

## 3. 实验结果

### 3.1 主要输出
![Figure_1](https://github.com/user-attachments/assets/9440a837-f5a4-457e-a2e3-364ca8f7ac41)
运行代码后，生成了一段动画，展示了弦在时间范围 [0, 0.1] 秒内的振动情况。动画显示了波从初始速度剖面（由函数 u_t(x) 定义）开始传播，沿弦向两端移动，并在边界处反射的过程。弦的长度为 1 米，波速为 100 m/s，空间步长 dx = 0.01 米，时间步长 dt = 5e-5 秒。动画中波形呈现平滑的传播和反射特性，振幅随时间逐渐演化。


### 3.2 结果验证
为了验证结果的正确性，进行了以下检查：  

1.边界条件：在整个模拟中，弦的两端位移 u(0, t) 和 u(L, t) 始终为零，符合代码中设置的边界条件。  

2.波形演化：波形从初始速度剖面开始传播，并在两端反射，呈现出预期的波动行为，与波动方程的物理特性一致。  

3.数值稳定性：稳定性条件 c = (a * dt / dx)^2 计算值为 c = (100 * 5e-5 / 0.01)^2 = 0.25 < 1，满足CFL条件，数值解保持稳定，未观察到发散现象。
## 4. 问题与收获

### 4.1 主要问题

在实验过程中，遇到了以下主要困难：  

1.初始速度条件的处理：如何正确地将初始速度剖面 ψ(x) 融入FTCS方案，特别是在计算第一个时间步时。  

2.数值稳定性：如何选择合适的 Δt 和 Δx 以确保稳定性条件 c < 1。  


### 4.2 解决方法

1.初始速度条件的处理：通过代码中的实现，第一个时间步的位移使用公式 u[:, 1] = psi * dt 计算，其中 psi 是初始速度剖面，确保了初始条件的正确应用。  

2.数值稳定性：通过计算 c = (a * dt / dx)^2，并验证其小于1，选择了适当的 dt = 5e-5 和 dx = 0.01，代码中还包含警告机制以检测 c ≥ 1 的情况。  


### 4.3 主要收获
通过本次实验，我获得了以下学习收获：  

1.加深了对波动方程和有限差分法（FTCS方案）的理解，掌握了偏微分方程离散化的基本方法。  

2.学会了使用Python的NumPy进行数组操作和Matplotlib制作动态可视化动画。  

3.认识到数值模拟中稳定性条件（如CFL条件）的重要性及其对结果的影响。  


## 5. 思考题（可选）

1.如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？  

改变初始速度剖面 ψ(x) 的形状会直接影响波的初始分布和传播模式。例如，若将参数 d 从 0.1 改为 0.5，波形将从弦的中部开始传播，而非靠近一端，可能导致更对称的振动模式。不同的 σ 值会影响波形的宽度和振幅，从而改变频率成分。  

2.尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？  

（1）当 Δt = 5e-5 和 Δx = 0.01 时，c = 0.25 < 1，数值解稳定且波形平滑。  

（2）若增大 Δt 至 1e-3（保持 Δx = 0.01），则 c = (100 * 1e-3 / 0.01)^2 = 100 > 1，数值解迅速发散，位移值在短时间内变得极大，失去物理意义。这是因为FTCS方案在 c ≥ 1 时不满足稳定性条件，误差随时间放大。  

