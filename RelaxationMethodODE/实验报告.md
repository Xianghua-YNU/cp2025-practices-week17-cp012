# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** [林郅康] **学号：** [20231050164] **完成日期：** [20250618]

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
import numpy as np
import matplotlib.pyplot as plt


def solve_ode(h, g, max_iter=10000, tol=1e-6):
    """
    实现松弛迭代法求解常微分方程 d²x/dt² = -g
    边界条件：x(0) = x(10) = 0（抛体运动问题）

    参数:
        h (float): 时间步长
        g (float): 重力加速度
        max_iter (int): 最大迭代次数
        tol (float): 收敛容差

    返回:
        tuple: (时间数组, 解数组)

    物理背景: 质量为1kg的球从高度x=0抛出，10秒后回到x=0
    数值方法: 松弛迭代法，迭代公式 x(t) = 0.5*h²*g + 0.5*[x(t+h)+x(t-h)]

    实现步骤:
    1. 初始化时间数组和解数组
    2. 应用松弛迭代公式直到收敛
    3. 返回时间和解数组
    """
    # 初始化时间数组
    t = np.arange(0, 10 + h, h)

    # 初始化解数组，边界条件已满足：x[0] = x[-1] = 0
    x = np.zeros(t.size)

    # 实现松弛迭代算法
    delta = 1.0
    iter_count = 0

    while delta > tol and iter_count < max_iter:
        x_new = np.copy(x)
        x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
        delta = np.max(np.abs(x_new - x))
        x = x_new
        iter_count += 1

    if iter_count >= max_iter:
        print(f"警告：达到最大迭代次数 {max_iter}，可能未收敛。")

    return t, x


if __name__ == "__main__":
    # 测试参数
    h = 10 / 100  # 时间步长
    g = 9.8  # 重力加速度

    # 调用求解函数
    t, x = solve_ode(h, g)

    # 绘制结果
    plt.plot(t, x)
    plt.xlabel('时间 (s)')
    plt.ylabel('高度 (m)')
    plt.title('抛体运动轨迹 (松弛迭代法)')
    plt.grid()
    plt.show()

    # 打印最高点的高度和时间
    max_height = np.max(x)
    time_at_max_height = t[np.argmax(x)]
    print(f"最高点高度: {max_height:.4f} m")
    print(f"达到最高点的时间: {time_at_max_height:.4f} s")
```

## 3. 实验结果

### 3.1 主要输出

- 最大高度：[121.5915] m
- 到达最大高度时间：[5.0000] s
- 迭代收敛次数：[10000] 次

### 3.2 结果验证

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状
- ![image](https://github.com/user-attachments/assets/62353efc-a3b6-4992-894f-3e843dcda4fc)


## 4. 问题与收获

### 4.1 主要问题

1. 收敛条件的设置
2.迭代公式的正确实现


### 4.2 解决方法

1. 使用最大变化量作为收敛判据
2. 仔细处理数组索引，确保边界条件

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？
边值问题特性：需满足多个边界条件，解的各点相互耦合，离散后形成联立方程组。
松弛法优势：通过迭代逐步调整各点值，利用相邻点信息更新当前解，最终满足全局约束，适配方程组的稀疏结构。
初值问题局限性：初值问题可通过步进法直接求解，松弛法迭代会增加计算开销，且无法利用其方向特性。
2. 如何选择合适的收敛容差和最大迭代次数？
收敛容差（tol）：
依问题精度需求设定，工程问题常用 1e-4~1e-6，高精度计算可设 1e-8。
需与离散误差（如步长 h）匹配，避免设置过高导致计算冗余。
最大迭代次数（max_iter）：
依问题复杂度和收敛速度估计，简单问题设 1000~10000 次，复杂问题可增至 10^5 次，防止无限循环。
结合迭代过程监控，若收敛缓慢需调整参数或算法。
